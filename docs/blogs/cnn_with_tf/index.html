<!DOCTYPE html>
<html lang="en-us"><head>
  <!-- Basic Page Needs -->
  <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  
  <meta name="description" content="Computer Vision / Deep Learning">
  <meta name="author" content="DSG">
  <meta name="generator" content="Hugo 0.100.2" />
  
  <!-- Mobile Specific Metas -->
  <meta name="format-detection" content="telephone=no">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Convolutional Neural Network with TensorFlow Implementation</title>
  <link rel="icon" href="/images/dsg_new_square_logo.png">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">
  <script src='https://kit.fontawesome.com/a076d05399.js' crossorigin='anonymous'></script>
  <!-- Twitter Bootstrs CSS -->
  <link rel="stylesheet" href="/plugins/bootstrap/bootstrap.min.css">
  <!-- Ionicons Fonts Css -->
  <link rel="stylesheet" href="/plugins/ionicons/ionicons.min.css">
  <!-- animate css -->
  <link rel="stylesheet" href="/plugins/animate-css/animate.css">
  <!-- Hero area slider css-->
  <link rel="stylesheet" href="/plugins/slider/slider.css">
  <!-- slick slider -->
  <link rel="stylesheet" href="/plugins/slick/slick.css">
  <!-- Fancybox -->
  <link rel="stylesheet" href="/plugins/facncybox/jquery.fancybox.css">
  <!-- hover -->
  <link rel="stylesheet" href="/plugins/hover/hover-min.css">
  <!-- template main css file -->
  
  <link rel="stylesheet" href="/css/style.min.css" integrity="" media="screen">
</head><body><section class="top-bar animated-header">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <nav class="navbar navbar-expand-lg navbar-light bg-light">
                    <a class="navbar-brand" href="/">
                        <img id="logo" src="/images/dsg.png" alt="logo">
                    </a>
                    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navigation"
                        aria-controls="navigation" aria-expanded="false" aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                    </button>

                    <div class="collapse navbar-collapse" id="navigation">
                        <ul class="navbar-nav ml-auto">
                            <li class="nav-item">
                                <a class="nav-link"
                                    href="/">Home
                                </a>
                            </li>
                            
                            <li class="nav-item">
                                
                                    <a class="nav-link" href="/#works">Work</a>
                                
                                
                                
                            </li>
                            
                            <li class="nav-item">
                                
                                
                                    <a class="nav-link" href="/events">News</a>
                                
                                
                            </li>
                            
                            <li class="nav-item">
                                
                                
                                    <a class="nav-link" href="/blogs">Blogs</a>
                                
                                
                            </li>
                            
                            <li class="nav-item">
                                
                                
                                    <a class="nav-link" href="/about">About</a>
                                
                                
                            </li>
                            
                    </div>
                </nav>
            </div>
        </div>
    </div>
</section>

<section class="global-page-header">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <div class="block">
                    <h2>Convolutional Neural Network with TensorFlow Implementation</h2>
                    <div class="portfolio-meta">
                        <span>Saturday, Jun 17, 2017</span>|
                        <span> Tags:
                            Deep Learning, TensorFlow
                        </span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="single-post">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                
                <div class="post-img">
                    <img class="img-fluid-work" alt="" src="https://cdn-images-1.medium.com/max/814/1*0QWEskEF9o9LHy9PoU3MZQ.jpeg">
                </div>
                
                <div class="post-content">
                    <blockquote>
<p>When you hear about deep learning breaking a new technological barrier, Convolutional Neural Networks are involved most of the times.</p>
</blockquote>
<h4 id="convolutional-neural-networks"><strong>Convolutional Neural Networks</strong></h4>
<p>Originally developed by <a href="http://yann.lecun.com/">Yann LeCun</a> decades ago, better known as <em>CNNs (ConvNets)</em> are one of the state of the art, Artificial Neural Network design architecture, which has proven its effectiveness in areas such as image recognition and classification. The Basic Principle behind the working of CNN is the idea of Convolution, producing filtered Feature Maps stacked over each other.</p>
<p>A convolutional neural network consists of several layers. Implicit explanation about each of these layers is given below.</p>
<ol>
<li><strong>Convolution Layer (Conv Layer)</strong></li>
</ol>
<p>The Conv layer is the core building block of a Convolutional Neural Network. The primary purpose of Conv layer is to extract features from the input image.</p>
<p><img src="https://cdn-images-1.medium.com/max/780/1*V4uobVv91cccRy9LtGYkKQ.gif" alt="Convolution"></p>
<p>The Conv Layer parameters consist of a set of learnable filters (kernels or feature detector). Filters are used for recognizing patterns throughout the entire input image. Convolution works by sliding the filter over the input image and along the way we take the dot product between the filter and chunks of the input image.</p>
<ol start="2">
<li><strong>Pooling Layer (Sub-sampling or Down-sampling)</strong></li>
</ol>
<p>Pooling layer reduce the size of feature maps by using some functions to summarize sub-regions, such as taking the average or the maximum value. Pooling works by sliding a window across the input and feeding the content of the window to a pooling function.</p>
<p><img src="https://cdn-images-1.medium.com/max/1008/1*C0EwU0aknuliOsGktK6U0g.png" alt="Max-Pooling and Average-Pooling"></p>
<p>The purpose of pooling is to reduce the number of parameters in our network (hence called down-sampling) and to make learned features more robust by making it more invariant to scale and orientation changes.</p>
<p><strong>3. ReLU Layer</strong></p>
<p>ReLU stands for Rectified Linear Unit and is a non-linear operation. ReLU is an element wise operation (applied per pixel) and replaces all negative pixel values in the feature map by zero.</p>
<h3 id="output--maxzero-input">Output = Max(zero, Input)</h3>
<p><img src="https://cdn-images-1.medium.com/max/2382/1*6HyqifN4M_bJ7DTJ0RFRJA.jpeg" alt="ReLU Layer"></p>
<p>The purpose of ReLU is to introduce non-linearity in our ConvNet, since most of the real-world data we would want our ConvNet to learn would be non-linear.</p>
<p>Other non linear functions such as <em>tanh</em> or <em>sigmoid</em> can also be used instead of ReLU, but ReLU has been found to perform better in most cases.</p>
<p><strong>4. Fully Connected Layer</strong></p>
<p>The Fully Connected layer is configured exactly the way its name implies: it is fully connected with the output of the previous layer. A fully connected layer takes all neurons in the previous layer (be it fully connected, pooling, or convolutional) and connects it to every single neuron it has.</p>
<p><img src="https://cdn-images-1.medium.com/max/738/1*Zd5ScCO-meZl9yrCw6ZC0Q.jpeg" alt="Fully Connected Layer"></p>
<p>Adding a fully-connected layer is also a cheap way of learning non-linear combinations of these features. Most of the features learned from convolutional and pooling layers may be good, but combinations of those features might be even better.</p>
<h4 id="tensorflow"><strong>TensorFlow</strong></h4>
<p><a href="https://www.tensorflow.org/">TensorFlow</a> is an open source software library created by Google for numerical computation using data flow graphs.</p>
<p><img src="https://cdn-images-1.medium.com/max/990/1*Jy52j6P_kTUgpfIBwM9Yuw.jpeg" alt=""></p>
<p>Nodes in the graph represent mathematical operations, while the graph edges represent the multidimensional data arrays (tensors) that flow between them. This flexible architecture lets you deploy computation to one or more CPU&rsquo;s or GPU’s in a desktop, server, or mobile device without rewriting code.</p>
<p>TensorFlow also includes <a href="https://www.tensorflow.org/get_started/summaries_and_tensorboard">TensorBoard</a>, a data visualization toolkit.</p>
<h1 id="building-a-cnn-in-tensorflow">Building a CNN in TensorFlow</h1>
<h4 id="dataset">Dataset</h4>
<p>In this article, we will be using <a href="http://yann.lecun.com/exdb/mnist/">MNIST</a>, a data-set of handwritten digits (The “hello world” of image recognition for machine learning and deep learning).</p>
<p><img src="https://cdn-images-1.medium.com/max/700/1*oxaoN1H168PBYPY8cFhbEQ.png" alt="MNIST Sample Images"></p>
<p>It is a digit recognition task. There are 10 digits (0 to 9) or 10 classes to predict. Each image is a 28 by 28 pixel square (784 pixels total). We’re given a total of 70,000 images.</p>
<h4 id="network-architecture">Network Architecture</h4>
<ul>
<li>
<p>Convolution, Filter shape:(5,5,6), Stride=1, Padding=’SAME’</p>
</li>
<li>
<p>Max pooling (2x2), Window shape:(2,2), Stride=2, Padding=’Same’</p>
</li>
<li>
<p>ReLU</p>
</li>
<li>
<p>Convolution, Filter shape:(5,5,16), Stride=1, Padding=’SAME’</p>
</li>
<li>
<p>Max pooling (2x2), Window shape:(2,2), Stride=2, Padding=’Same’</p>
</li>
<li>
<p>ReLU</p>
</li>
<li>
<p>Fully Connected Layer (128)</p>
</li>
<li>
<p>ReLU</p>
</li>
<li>
<p>Fully Connected Layer (10)</p>
</li>
<li>
<p>Softmax</p>
</li>
</ul>
<p><img src="https://cdn-images-1.medium.com/max/3712/1*7K4ZTTfZb-hbjoADbisHAg.png" alt="Architecture"></p>
<h4 id="code">Code</h4>
<script src="https://gist.github.com/SinghalHarsh/5d599cbfd38e7fcdb78d5c3802f12187.js"></script>
<p>We can plot the validation accuracy and loss versus the number of epoch’s using TensorBoard :</p>
<p><img src="https://cdn-images-1.medium.com/max/2066/1*zgrgEmWUXS_lWTl26wWSgQ.png" alt="Validation Accuracy"></p>
<p><img src="https://cdn-images-1.medium.com/max/2074/1*c_PKX-1kcTwGAt0k1XdUjw.png" alt="Validation Loss"></p>
<p>With minimal efforts, we managed to reach an accuracy of 99% which is not that bad for a classification task with 10 labels. This result has been achieved without extensive optimization of the convolutional neural network’s parameters, and also without any form of regularization. To improve the performances, we could set up more complex model architectures so as to refine the feature extraction.</p>
<p>See the results of our Convolutional Neural Network on some validation examples:</p>
<p><img src="https://cdn-images-1.medium.com/max/540/1*vDvnNlZWnWHsI2u01M2kCA.gif" alt="MNIST Sample Classifications"></p>
<h4 id="conclusion">Conclusion</h4>
<p>Through this post, we were able to implement the simple Convolutional Neural Network architecture using the Python programming language and the TensorFlow library for deep learning. There are several details that are oversimplified / skipped but hopefully this post gave you some intuition of how it works.</p>
<p>Thanks for reading!</p>
<p>In case you have any doubts/feedback, kindly comment.</p>

                </div>
            </div>
        </div>
    </div>
</section>

<!-- Footer Section Start -->
<footer id="footer">
    <div class="container" id="footer-container">
        <div class="row content-justify-between">
            <div style="width: 100%;">
                <p class="copyright">
                    Contact Us
                </p>
            </div>
            <div class="col-md-7 col-12 text-lg-left text-md-left">
                <!-- Social Media -->
                <ul class="social">
                    
                    <li><a href="mailto:dsg@iitr.ac.in"><i class="ion-android-mail"></i></a></li>
                    
                    <li><a href="https://www.facebook.com/dsgiitr/"><i class="ion-social-facebook"></i></a></li>
                    
                    <li><a href="https://github.com/dsgiitr"><i class="ion-social-github"></i></a></li>
                    
                    <li><a href="https://www.linkedin.com/company/26638705/"><i class="ion-social-linkedin"></i></a></li>
                    
                    <li><a href="https://twitter.com/dsg_iitr"><i class="ion-social-twitter"></i></a></li>
                    
                    <li><a href="https://www.instagram.com/dsgiitr/"><i class="ion-social-instagram"></i></a></li>
                    
                    <li><a href="https://discord.com/invite/ATDN5D9M"><i class="fab fa-discord"></i></a></li>
                    
                    
                    <li style="float: right; color: #FFFFFF;"><i class="ion-closed-captioning"></i> DSG IITR</li>
                    
                </ul>
            </div>
            <div class="col-md-5 col-12 text-lg-left text-md-left location-foot">
                
                <div style="float: right; color: #FFFFFF;">
                    <i class="ion-ios-location" style="color: #000;"></i> New Sac Building, IIT Roorkee
                </div>
                
            </div>
        </div>
    </div>
    
    <script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
  });
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i = 0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });

  MathJax.Hub.Config({
  
  TeX: { equationNumbers: { autoNumber: "AMS" } }
  });
</script>
</footer>
<!-- footer section end -->


<!-- jquery -->
<script src="/plugins/jQurey/jquery.min.js"></script>
<!-- Form Validation -->
<script src="/plugins/form-validation/jquery.form.js"></script>
<script src="/plugins/form-validation/jquery.validate.min.js"></script>
<!-- slick slider -->
<script src="/plugins/slick/slick.min.js"></script>
<!-- bootstrap js -->
<script src="/plugins/bootstrap/bootstrap.min.js"></script>
<!-- wow js -->
<script src="/plugins/wow-js/wow.min.js"></script>
<!-- slider js -->
<script src="/plugins/slider/slider.js"></script>
<!-- Fancybox -->
<script src="/plugins/facncybox/jquery.fancybox.js"></script>
<!-- template main js -->

<script src="/js/script.min.js"></script>
<!-- google analitycs -->
<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', '', 'auto');
    ga('send', 'pageview');
</script>
<script type="text/javascript" src="/plugins/particlesjs/particles.min.js"></script>
<script type="text/javascript" src="/plugins/particlesjs/demo/js/app.js"></script></body>
</html>